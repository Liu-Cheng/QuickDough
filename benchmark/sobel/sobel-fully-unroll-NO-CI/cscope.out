cscope 15 $HOME/gitrepo/project/benchmark/sobel/sobel-fully-unroll               0000018281
	@config.h

1 #iâdeà
__CONFIG_H__


2 
	#__CONFIG_H__


	)

4 
	#R
 8

	)

5 
	#C
 8

	)

	@dfg-gen.cpp

1 
	~"commÚ.h
"

2 
	~"O³¿nd.h
"

3 
	~"In¡ruùiÚ.h
"

4 
	~"cÚfig.h
"

5 
	~<li¡
>

7 
IO_In™
(
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]);

8 
OP_A¼ay_In™
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, 
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]);

9 
K”Ãl_To_DFG
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
);

10 
DFG_Compu‹
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
);

11 
V”ify
(cÚ¡ 
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, 
Fig_Out
[
R
*
C
/4]);

12 
DFG_Dump
(cÚ¡ 
¡d
::
¡ršg
 &
DFG_Name
, cÚ¡ std::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, cÚ¡ std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
);

13 
D©a_To_ID
(
¡d
::
¡ršg
 
Name
, 
IDx
, 
IDy
);

14 
In™Ÿl_IO_PÏûm’t
(cÚ¡ 
¡d
::
¡ršg
 &
DFG_Name
);

15 
H—d_Fže_Dump
(
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]);

17 
	gCÚ¡_In
[5]={0, 8, 16, 24, 255};

18 cÚ¡ 
	gCÚ¡_Num
=5;

20 
	$maš
(){

22 
Fig_In
[
R
*
C
/4];

23 
Fig_Out
[
R
*
C
/4];

25 
Gx
[3][3]={

31 
Gy
[3][3]={

37 
¡d
::
veùÜ
<
O³¿nd
*> 
OP_A¼ay
;

38 
¡d
::
veùÜ
<
In¡ruùiÚ
*> 
In¡_A¼ay
;

39 
¡d
::
¡ršg
 
DFG_Name
="sobel";

41 
	`IO_In™
(
Fig_In
, 
Gx
, 
Gy
, 
Fig_Out
);

42 
	`OP_A¼ay_In™
(
OP_A¼ay
, 
Fig_In
, 
Gx
, 
Gy
, 
Fig_Out
);

43 
	`K”Ãl_To_DFG
(
OP_A¼ay
, 
In¡_A¼ay
);

44 
	`DFG_Compu‹
(
OP_A¼ay
, 
In¡_A¼ay
);

45 
	`V”ify
(
OP_A¼ay
, 
Fig_Out
);

46 
	`DFG_Dump
(
DFG_Name
, 
OP_A¼ay
, 
In¡_A¼ay
);

47 
	`In™Ÿl_IO_PÏûm’t
(
DFG_Name
);

48 
	`H—d_Fže_Dump
(
Fig_In
, 
Gx
, 
Gy
, 
Fig_Out
);

49 
	}
}

51 
IO_In™
(
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]){

53 
	gPixl_In
[
R
][
C
];

54 
	gPixl_Out
[
R
][
C
];

56 
	gi
=0; i<
	gR
; i++){

57 
	gj
=0; j<
	gC
; j++){

58 
	gPixl_In
[
i
][
j
] = 
¿nd
()%256;

62 
	gi
=0; i<
	gR
; i++){

63 
	gj
=0; j<
	gC
; j++){

64 if(
	gi
==0 || 
j
==0 || 
i
==
R
-1 || j==
C
-1){

65 
Pixl_Out
[
i
][
j
] = 255;

68 
	gSumx
 = 0;

69 
	gSumy
 = 0;

70 
	gp
=-1;…<=1;…++){

71 
	gq
=-1; q<=1; q++){

72 
	gSumx
 +ð
Pixl_In
[
i
+
p
][
j
+
q
]*
Gx
[p+1][q+1];

73 
	gSumy
 +ð
Pixl_In
[
i
+
p
][
j
+
q
]*
Gy
[p+1][q+1];

76 
	gSum
 = 
abs
(
Sumx
è+‡bs(
Sumy
);

77 if(
	gSum
>255){

78 
	gPixl_Out
[
i
][
j
] = 0;

81 
	gPixl_Out
[
i
][
j
] = 255-
Sum
;

87 
	gID
=0;

88 
	gi
=0; i<
	gR
; i++){

89 
	gj
=0; j<
	gC
; j=
j
+4){

90 
Pixl0
, 
Pixl1
, 
Pixl2
, 
Pixl3
;

91 
	gPixl0
=()
Pixl_In
[
i
][
j
];

92 
	gPixl1
=()
Pixl_In
[
i
][
j
+1]<<8;

93 
	gPixl2
=()
Pixl_In
[
i
][
j
+2]<<16;

94 
	gPixl3
=()
Pixl_In
[
i
][
j
+3]<<24;

95 
	gFig_In
[
ID
]=
Pixl0
+
Pixl1
+
Pixl2
+
Pixl3
;

96 
	gID
++;

100 
	gID
=0;

101 
	gi
=0; i<
	gR
; i++){

102 
	gj
=0; j<
	gC
; j=
j
+4){

103 
Pixl0
, 
Pixl1
, 
Pixl2
, 
Pixl3
;

104 
	gPixl0
=()
Pixl_Out
[
i
][
j
];

105 
	gPixl1
=()
Pixl_Out
[
i
][
j
+1]<<8;

106 
	gPixl2
=()
Pixl_Out
[
i
][
j
+2]<<16;

107 
	gPixl3
=()
Pixl_Out
[
i
][
j
+3]<<24;

108 
	gFig_Out
[
ID
]=
Pixl0
+
Pixl1
+
Pixl2
+
Pixl3
;

109 
	gID
++;

115 
OP_A¼ay_In™
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, 
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]){

117 
	gB¿m0_Addr
=0;

118 
	gB¿m1_Addr
=0;

121 
	gi
=0; i<
	gCÚ¡_Num
; i++){

122 
O³¿nd
* 
	gOP_PŒ
=
Ãw
 Operand();

123 
	gOP_A¼ay
.
push_back
(
OP_PŒ
);

124 
	gOP_PŒ
->
S‘_O³¿nd
(
CÚ¡_In
[
i
], 0, 
B¿m0_Addr
, 
INCONST
);

125 
	gB¿m0_Addr
++;

128 
	gi
=0; i<
R
*
	gC
/4; i++){

129 
O³¿nd
* 
	gOP_PŒ
=
Ãw
 Operand();

130 
	gOP_A¼ay
.
push_back
(
OP_PŒ
);

131 
	gOP_PŒ
->
S‘_O³¿nd
(
Fig_In
[
i
], 0, 
B¿m0_Addr
, 
INVAR
);

132 
	gB¿m0_Addr
++;

135 
	gi
=0; i<3; i++){

136 
	gj
=0; j<3; j++){

137 
O³¿nd
* 
	gOP_PŒ
=
Ãw
 Operand();

138 
	gOP_A¼ay
.
push_back
(
OP_PŒ
);

139 
	gOP_PŒ
->
S‘_O³¿nd
(
Gx
[
i
][
j
], 0, 
B¿m0_Addr
, 
INVAR
);

140 
	gB¿m0_Addr
++;

144 
	gi
=0; i<3; i++){

145 
	gj
=0; j<3; j++){

146 
O³¿nd
* 
	gOP_PŒ
=
Ãw
 Operand();

147 
	gOP_A¼ay
.
push_back
(
OP_PŒ
);

148 
	gOP_PŒ
->
S‘_O³¿nd
(
Gy
[
i
][
j
], 0, 
B¿m0_Addr
, 
INVAR
);

149 
	gB¿m0_Addr
++;

154 
	gi
=0; i<
R
*
	gC
/4; i++){

155 
O³¿nd
* 
	gOP_PŒ
=
Ãw
 Operand();

156 
	gOP_A¼ay
.
push_back
(
OP_PŒ
);

157 
	gOP_PŒ
->
S‘_O³¿nd
(0, 1, 
B¿m1_Addr
, 
OUTVAR
);

158 
	gB¿m1_Addr
++;

163 
D©a_To_ID
(
¡d
::
¡ršg
 
Name
, 
IDx
, 
IDy
){

165 if(
	gName
=="Const_In"){

166  (
IDx
);

168 if(
	gName
=="Fig_In"){

169  (
IDx
+
CÚ¡_Num
);

171 if(
	gName
=="Gx"){

172  (
IDx
*3 + 
IDy
 + 
CÚ¡_Num
 + 
R
*
C
/4);

174 if(
	gName
=="Gy"){

175  (
IDx
*3 + 
IDy
 + 
CÚ¡_Num
 + 
R
*
C
/4 + 3*3);

177 if(
	gName
=="Fig_Out"){

178  (
IDx
 + 
CÚ¡_Num
 + 
R
*
C
/4 + 3*3 + 3*3);

181 
´štf
("Unknown IO operands! \n");

182 
ex™
(
EXIT_FAILURE
);

187 
K”Ãl_To_DFG
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
){

189 
i
=0; 
	gi
<
	gR
; i++){

190 
	gj
=0; j<
	gC
; j=
j
+4){

193 
O³¿nd
* 
Ýx
[4];

194 
O³¿nd
* 
	gÝy
[4];

195 
O³¿nd
* 
	gÝ
[4];

196 
	gk
=0; k<4; k++){

197 
	gÝx
[
k
]=
Ãw
 
O³¿nd
();

198 
	gÝy
[
k
]=
Ãw
 
O³¿nd
();

199 
	gÝ
[
k
]=
Ãw
 
O³¿nd
();

200 
	gOP_A¼ay
.
push_back
(
Ýx
[
k
]);

201 
	gOP_A¼ay
.
push_back
(
Ýy
[
k
]);

202 
	gOP_A¼ay
.
push_back
(
Ý
[
k
]);

205 
	gp
=-1;…<=1;…++){

206 
	gq
=-1; q<=1; q++){

207 
	gby‹_id
, 
	gwÜd_id
, 
	gby‹_lid
;

208 
	g¤c_id0
[4];

209 
	g¤c_id1
[4];

210 
	g¤c_id2
[4];

211 
	gÏ¡_idx
[4];

212 
	gÏ¡_idy
[4];

215 
O³¿nd
* 
	gpixl
[4];

221 
	gk
=0; k<4; k++){

224 
	gby‹_id
=(
i
+
p
)*
C
+
j
+
q
+
k
;

225 
	gwÜd_id
=
by‹_id
/4;

226 
	gby‹_lid
=
by‹_id
%4;

227 
	gpixl
[
k
]=
Ãw
 
O³¿nd
();

228 
	gOP_A¼ay
.
push_back
(
pixl
[
k
]);

229 
In¡ruùiÚ
* 
	gš¡0
=
Ãw
 Instruction();

230 
	gIn¡_A¼ay
.
push_back
(
š¡0
);

231 if((
	gi
+
	gp
)<0 || (
	gj
+
	gq
+
	gk
)<0 || (i+p)>=
R
 || (
j
+
q
+
k
)>=
C
){

232 
¤c_id0
[
k
] = 0;

233 
	g¤c_id1
[
k
] = 0;

234 
	g¤c_id2
[
k
] = 0;

235 
	gš¡0
->
S‘_In¡ruùiÚ
(
pixl
[
k
]->
OP_ID
, 
ADDADD
, 
¤c_id0
[k], 
¤c_id1
[k], 
¤c_id2
[k]);

238 
	g¤c_id0
[
k
]=
D©a_To_ID
("Fig_In", 
wÜd_id
, 0);

239 
	g¤c_id1
[
k
]=
D©a_To_ID
("CÚ¡_In", 
by‹_lid
, 0);

240 
	g¤c_id2
[
k
]=
D©a_To_ID
("Const_In", 4, 0);

241 
	gš¡0
->
S‘_In¡ruùiÚ
(
pixl
[
k
]->
OP_ID
, 
RSFAND
, 
¤c_id0
[k], 
¤c_id1
[k], 
¤c_id2
[k]);

244 if(
	gp
==-1 && 
q
==-1){

245 
O³¿nd
* 
cu¼_Ý
=
Ãw
 Operand();

246 
	gOP_A¼ay
.
push_back
(
cu¼_Ý
);

247 
In¡ruùiÚ
* 
	gcu¼_š¡
=
Ãw
 Instruction();

248 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

250 
	g¤c_id0
[
k
]=
pixl
[k]->
OP_ID
;

251 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gx", 
p
+1, 
q
+1);

252 
	g¤c_id2
[
k
]=0;

253 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
cu¼_Ý
->
OP_ID
, 
MULADD
, 
¤c_id0
[
k
], 
¤c_id1
[k], 
¤c_id2
[k]);

254 
	gÏ¡_idx
[
k
]=
cu¼_Ý
->
OP_ID
;

256 
	gcu¼_Ý
=
Ãw
 
O³¿nd
();

257 
	gOP_A¼ay
.
push_back
(
cu¼_Ý
);

258 
	gcu¼_š¡
=
Ãw
 
In¡ruùiÚ
();

259 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

261 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gy", 
p
+1, 
q
+1);

262 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
cu¼_Ý
->
OP_ID
, 
MULADD
, 
¤c_id0
[
k
], 
¤c_id1
[k], 
¤c_id2
[k]);

263 
	gÏ¡_idy
[
k
]=
cu¼_Ý
->
OP_ID
;

265 if(
	gp
==1 && 
q
==1){

266 
In¡ruùiÚ
* 
cu¼_š¡
=
Ãw
 Instruction();

267 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

268 
	g¤c_id0
[
k
]=
pixl
[k]->
OP_ID
;

269 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gx", 
p
+1, 
q
+1);

270 
	g¤c_id2
[
k
]=
Ï¡_idx
[k];

271 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
Ýx
[
k
]->
OP_ID
, 
MULADD
, 
¤c_id0
[k], 
¤c_id1
[k], 
¤c_id2
[k]);

273 
	gcu¼_š¡
=
Ãw
 
In¡ruùiÚ
();

274 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

275 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gy", 
p
+1, 
q
+1);

276 
	g¤c_id2
[
k
]=
Ï¡_idy
[k];

277 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
Ýy
[
k
]->
OP_ID
, 
MULADD
, 
¤c_id0
[k], 
¤c_id1
[k], 
¤c_id2
[k]);

281 
O³¿nd
* 
	gcu¼_Ý
=
Ãw
 Operand();

282 
	gOP_A¼ay
.
push_back
(
cu¼_Ý
);

283 
In¡ruùiÚ
* 
	gcu¼_š¡
=
Ãw
 Instruction();

284 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

286 
	g¤c_id0
[
k
]=
pixl
[k]->
OP_ID
;

287 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gx", 
p
+1, 
q
+1);

288 
	g¤c_id2
[
k
]=
Ï¡_idx
[k];

289 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
cu¼_Ý
->
OP_ID
, 
MULADD
, 
¤c_id0
[
k
], 
¤c_id1
[k], 
¤c_id2
[k]);

290 
	gÏ¡_idx
[
k
]=
cu¼_Ý
->
OP_ID
;

292 
	gcu¼_Ý
=
Ãw
 
O³¿nd
();

293 
	gOP_A¼ay
.
push_back
(
cu¼_Ý
);

294 
	gcu¼_š¡
=
Ãw
 
In¡ruùiÚ
();

295 
	gIn¡_A¼ay
.
push_back
(
cu¼_š¡
);

297 
	g¤c_id0
[
k
]=
pixl
[k]->
OP_ID
;

298 
	g¤c_id1
[
k
]=
D©a_To_ID
("Gy", 
p
+1, 
q
+1);

299 
	g¤c_id2
[
k
]=
Ï¡_idy
[k];

300 
	gcu¼_š¡
->
S‘_In¡ruùiÚ
(
cu¼_Ý
->
OP_ID
, 
MULADD
, 
¤c_id0
[
k
], 
¤c_id1
[k], 
¤c_id2
[k]);

301 
	gÏ¡_idy
[
k
]=
cu¼_Ý
->
OP_ID
;

308 
	gk
=0; k<4; k++){

309 
O³¿nd
* 
	gabs_sumx
=
Ãw
 Operand();

310 
	gOP_A¼ay
.
push_back
(
abs_sumx
);

311 
In¡ruùiÚ
* 
	gš¡_sumx
=
Ãw
 Instruction();

312 
	gš¡_sumx
->
S‘_In¡ruùiÚ
(
abs_sumx
->
OP_ID
, 
ABS
, 
Ýx
[
k
]->OP_ID, 0, 0);

313 
	gIn¡_A¼ay
.
push_back
(
š¡_sumx
);

315 
O³¿nd
* 
	gabs_sumy
=
Ãw
 Operand();

316 
	gOP_A¼ay
.
push_back
(
abs_sumy
);

317 
In¡ruùiÚ
* 
	gš¡_sumy
=
Ãw
 Instruction();

318 
	gš¡_sumy
->
S‘_In¡ruùiÚ
(
abs_sumy
->
OP_ID
, 
ABS
, 
Ýy
[
k
]->OP_ID, 0, 0);

319 
	gIn¡_A¼ay
.
push_back
(
š¡_sumy
);

321 
O³¿nd
* 
	gabs_sum
=
Ãw
 Operand();

322 
	gOP_A¼ay
.
push_back
(
abs_sum
);

323 
In¡ruùiÚ
* 
	gš¡_sum
=
Ãw
 Instruction();

324 
	gš¡_sum
->
S‘_In¡ruùiÚ
(
abs_sum
->
OP_ID
, 
ADDADD
, 
abs_sumx
->OP_ID, 
abs_sumy
->OP_ID, 0);

325 
	gIn¡_A¼ay
.
push_back
(
š¡_sum
);

327 
O³¿nd
* 
	gÝ_æag
=
Ãw
 Operand();

328 
	gOP_A¼ay
.
push_back
(
Ý_æag
);

329 
In¡ruùiÚ
* 
	gš¡_æag
=
Ãw
 Instruction();

330 
	gš¡_æag
->
S‘_In¡ruùiÚ
(
Ý_æag
->
OP_ID
, 
GT
, 
abs_sum
->OP_ID, 
D©a_To_ID
("Const_In", 4, 0), 0);

331 
	gIn¡_A¼ay
.
push_back
(
š¡_æag
);

333 
O³¿nd
* 
	gÝ_sub
=
Ãw
 Operand();

334 
	gOP_A¼ay
.
push_back
(
Ý_sub
);

335 
In¡ruùiÚ
* 
	gš¡_sub
=
Ãw
 Instruction();

336 
	gš¡_sub
->
S‘_In¡ruùiÚ
(
Ý_sub
->
OP_ID
, 
SUBSUB
, 
D©a_To_ID
("CÚ¡_In", 4, 0), 
abs_sum
->OP_ID, 0);

337 
	gIn¡_A¼ay
.
push_back
(
š¡_sub
);

339 
In¡ruùiÚ
* 
	gš¡_phi
=
Ãw
 Instruction();

340 
	gš¡_phi
->
S‘_In¡ruùiÚ
(
Ý
[
k
]->
OP_ID
, 
PHI
, 
Ý_æag
->OP_ID, 0, 
Ý_sub
->OP_ID);

341 
	gIn¡_A¼ay
.
push_back
(
š¡_phi
);

345 
O³¿nd
* 
	gÝ_tmp1
=
Ãw
 Operand();

346 
	gOP_A¼ay
.
push_back
(
Ý_tmp1
);

347 
In¡ruùiÚ
* 
	gš¡_tmp1
=
Ãw
 Instruction();

348 
	gš¡_tmp1
->
S‘_In¡ruùiÚ
(
Ý_tmp1
->
OP_ID
, 
LSFADD
, 
Ý
[1]->OP_ID, 
D©a_To_ID
("Const_In", 1, 0), op[0]->OP_ID);

349 
	gIn¡_A¼ay
.
push_back
(
š¡_tmp1
);

351 
O³¿nd
* 
	gÝ_tmp2
=
Ãw
 Operand();

352 
	gOP_A¼ay
.
push_back
(
Ý_tmp2
);

353 
In¡ruùiÚ
* 
	gš¡_tmp2
=
Ãw
 Instruction();

354 
	gš¡_tmp2
->
S‘_In¡ruùiÚ
(
Ý_tmp2
->
OP_ID
, 
LSFADD
, 
Ý
[2]->OP_ID, 
D©a_To_ID
("CÚ¡_In", 2, 0), 
Ý_tmp1
->OP_ID);

355 
	gIn¡_A¼ay
.
push_back
(
š¡_tmp2
);

357 
	gnid
=(
i
*
C
+
j
)/4;

358 
In¡ruùiÚ
* 
	gš¡_out
=
Ãw
 Instruction();

359 
	gš¡_out
->
S‘_In¡ruùiÚ
(
D©a_To_ID
("Fig_Out", 
nid
, 0), 
LSFADD
, 
Ý
[3]->
OP_ID
, D©a_To_ID("CÚ¡_In", 3, 0), 
Ý_tmp2
->OP_ID);

360 
	gIn¡_A¼ay
.
push_back
(
š¡_out
);

365 
DFG_Compu‹
(
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
){

367 
¡d
::
veùÜ
<
In¡ruùiÚ
*>::
™”©Ü
 
In¡_It
;

368 
	gIn¡_It
=
In¡_A¼ay
.
begš
(); In¡_It!=In¡_A¼ay.
’d
(); Inst_It++){

369 
	g¤c_v®0
=
OP_A¼ay
[(*
In¡_It
)->
Src_OP0
]->
OP_V®
;

370 
	g¤c_v®1
=
OP_A¼ay
[(*
In¡_It
)->
Src_OP1
]->
OP_V®
;

371 
	g¤c_v®2
=
OP_A¼ay
[(*
In¡_It
)->
Src_OP2
]->
OP_V®
;

372 
	gd¡_v®
=(*
In¡_It
)->
Compu‹
(
¤c_v®0
, 
¤c_v®1
, 
¤c_v®2
);

373 
	gOP_A¼ay
[(*
In¡_It
)->
D¡_OP
]->
	gOP_V®
=
d¡_v®
;

378 
V”ify
(cÚ¡ 
¡d
::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, 
Fig_Out
[
R
*
C
/4]){

382 
	gDFG_ResuÉ
[
R
*
C
/4];

383 
	gi
=0; i<
	gR
; i++){

384 
	gj
=0; j<
	gC
; j=
j
+4){

385 
šdex
=(
i
*
C
+
j
)/4;

386 
	gOP_ID
=
D©a_To_ID
("Fig_Out", 
šdex
, 0);

387 
	gDFG_ResuÉ
[
šdex
] = 
OP_A¼ay
[
OP_ID
]->
OP_V®
;

392 * 
	gPŒ1
;

393 * 
	gPŒ2
;

394 
	gPŒ1
 = (*è
Fig_Out
;

395 
	gPŒ2
 = (*è
DFG_ResuÉ
;

397 
	gi
=1; i<
	gR
-1; i++){

398 
	gj
=1; j<
	gC
-1; j++){

399 if(
	gPŒ1
[
i
*
C
+
j
]!=
PŒ2
[i*C+j]){

400 
´štf
("V”ifiÿtiÚ fažed! Ex³ùed ResuÉ[%d][%d]=%d, Compu‹d ResuÉ=%d. \n", 
i
, 
j
, 
PŒ1
[i*
C
+j], 
PŒ2
[i*C+j]);

401 
ex™
(
EXIT_FAILURE
);

406 
´štf
("Verification…assed!\n");

411 
DFG_Dump
(cÚ¡ 
¡d
::
¡ršg
 &
DFG_Name
, cÚ¡ std::
veùÜ
<
O³¿nd
*> &
OP_A¼ay
, cÚ¡ std::veùÜ<
In¡ruùiÚ
*> &
In¡_A¼ay
){

412 
¡d
::
o¡ršg¡»am
 
oss
;

413 
	goss
 << "./dump/kernel-operand.txt";

414 
	g¡d
::
of¡»am
 
Ý”ªd_fhªdË
;

415 
	gÝ”ªd_fhªdË
.
Ý’
(
oss
.
¡r
().
c_¡r
());

416 if(!
	gÝ”ªd_fhªdË
.
is_Ý’
()){

417 
	g¡d
::
cout
 << "FažedØÝ’ " << 
oss
.
¡r
() << "\n";

418 
ex™
(
EXIT_FAILURE
);

421 
	goss
.
þ—r
();

422 
	goss
.
¡r
("");

423 
	goss
 << "./dump/dfg.s";

424 
	g¡d
::
of¡»am
 
š¡_fhªdË
;

425 
	gš¡_fhªdË
.
Ý’
(
oss
.
¡r
().
c_¡r
());

426 if(!
	gš¡_fhªdË
.
is_Ý’
()){

427 
	g¡d
::
cout
 << "FažedØÝ’" <<
oss
.
¡r
() << "\n";

428 
ex™
(
EXIT_FAILURE
);

431 
	goss
.
þ—r
();

432 
	goss
.
¡r
("");

433 
	goss
 << "./dump/kernel-opcode.txt";

434 
	g¡d
::
of¡»am
 
Opcode_fHªdË
;

435 
	gOpcode_fHªdË
.
Ý’
(
oss
.
¡r
().
c_¡r
());

436 if(!
	gOpcode_fHªdË
.
is_Ý’
()){

437 
	g¡d
::
cout
 << "FažedØÝ’ " << 
oss
.
¡r
() << "\n";

438 
ex™
(
EXIT_FAILURE
);

442 
	g¡d
::
veùÜ
<
O³¿nd
*>::
cÚ¡_™”©Ü
 
Ý_™
;

443 
	gÝ_™
=
OP_A¼ay
.
begš
(); op_™!=OP_A¼ay.
’d
(); op_it++){

444 
	gÝ”ªd_fhªdË
 << (*
	gÝ_™
)->
	gOP_ID
 << " " \

445 << (*
	gÝ_™
)->
	gIO_Bufãr_Addr
 << " " \

446 << (*
	gÝ_™
)->
	gOP_V®
 << " " \

447 << (*
	gÝ_™
)->
	gIO_Bufãr_ID
 << " " \

448 << (*
	gÝ_™
)->
	gOP_Ty³
 << "\n";

450 
	gÝ”ªd_fhªdË
.
þo£
();

453 
	g¡d
::
m­
<
Opcode
, > 
	gOpcode_Encod”
;

454 
	gOpcode_ID
=0;

455 
	g¡d
::
veùÜ
<
In¡ruùiÚ
*>::
cÚ¡_™”©Ü
 
In¡_It
;

456 
	gIn¡_It
=
In¡_A¼ay
.
begš
(); In¡_It!=In¡_A¼ay.
’d
(); Inst_It++){

457 
	gš¡_fhªdË
 << (*
	gIn¡_It
)->
	gD¡_OP
 << " " \

458 << (*
	gIn¡_It
)->
	gIn¡_Opcode
 << " " \

459 << (*
	gIn¡_It
)->
	gSrc_OP0
 << " " \

460 << (*
	gIn¡_It
)->
	gSrc_OP1
 << " " \

461 << (*
	gIn¡_It
)->
	gSrc_OP2
 << "\n";

462 if(
	gOpcode_Encod”
.
couÁ
((*
In¡_It
)->
In¡_Opcode
)<=0){

463 
Opcode_Encod”
[(*
In¡_It
)->
In¡_Opcode
]=
Opcode_ID
;

464 
	gOpcode_ID
++;

467 
	gš¡_fhªdË
.
þo£
();

470 
	g¡d
::
m­
<
Opcode
, >::
™”©Ü
 
M­_It
;

471 
	gM­_It
=
Opcode_Encod”
.
begš
(); M­_It!=Opcode_Encod”.
’d
(); Map_It++){

472 
	gOpcode_fHªdË
 << 
	gM­_It
->
	gfœ¡
 << 
	g¡d
::
’dl
;

474 
	gOpcode_fHªdË
.
þo£
();

478 
H—d_Fže_Dump
(
Fig_In
[
R
*
C
/4], 
Gx
[3][3], 
Gy
[3][3], 
Fig_Out
[R*C/4]){

480 
	g¡d
::
¡ršg
 
fName
 = "./dump/IO.h";

481 
	g¡d
::
of¡»am
 
fHªdË
;

482 
	gfHªdË
.
Ý’
(
fName
.
c_¡r
());

483 if(!
	gfHªdË
.
is_Ý’
()){

484 
	g¡d
::
cout
 << 
fName
 << "Ý’ƒ¼Ü!" << 
¡d
::
’dl
;

485 
ex™
(
EXIT_FAILURE
);

488 
	gfHªdË
 << "#iâdeà_IO_H_" << 
	g¡d
::
’dl
;

489 
	gfHªdË
 << "#defš_IO_H_" << 
	g¡d
::
’dl
 << 
¡d
::endl;

491 
	gfHªdË
 << "šˆCÚ¡_In[" << 
	gCÚ¡_Num
 << "] = "<<"{";

492 
	gi
=0; i<
	gCÚ¡_Num
; i++){

493 if(
	gi
==
CÚ¡_Num
-1){

494 
fHªdË
 << 
CÚ¡_In
[
i
] << "};" << 
¡d
::
’dl
;

497 
	gfHªdË
 << 
	gCÚ¡_In
[
i
] << ", ";

502 
	gfHªdË
 << "ch¬ Fig_In[" << 
	gR
 <<"][" << 
	gC
 << "];" << 
	g¡d
::
’dl
;

503 
	gfHªdË
 << "šˆGx[" << 3 << "][" << 3 <<"];" << 
	g¡d
::
’dl
;

504 
	gfHªdË
 << "šˆGy[" << 3 << "][" << 3 <<"];" << 
	g¡d
::
’dl
;

505 
	gfHªdË
 << "ch¬ Fig_Out[" << 
	gR
 << "][" << 
	gC
 << "];" << 
	g¡d
::
’dl
;

507 
	gfHªdË
 << 
	g¡d
::
’dl
 << "#’dif" << 
¡d
::endl;

511 
In™Ÿl_IO_PÏûm’t
(cÚ¡ 
¡d
::
¡ršg
 &
DFG_Name
){

513 
¡d
::
o¡ršg¡»am
 
oss
;

514 
	goss
 << "./dump/block-io.txt";

515 
	g¡d
::
of¡»am
 
fHªdË
;

516 
	gfHªdË
.
Ý’
(
oss
.
¡r
().
c_¡r
());

517 if(!
	gfHªdË
.
is_Ý’
()){

518 
	g¡d
::
cout
 << "FažedØÝ’ " << 
oss
.
¡r
() << "\n";

519 
ex™
(
EXIT_FAILURE
);

529 
	gRem­³d_B¿m0_Addr
 = 0;

530 
	gRem­³d_B¿m1_Addr
 = 0;

531 
	gCÚ¡_In_Addr
[5];

532 
	gFig_In_Addr
[
R
*
C
/4];

533 
	gGx_Addr
[3][3];

534 
	gGy_Addr
[3][3];

535 
	gFig_Out_Addr
[
R
*
C
/4];

538 
	gi
=0; i<
	gCÚ¡_Num
; i++){

539 
	gCÚ¡_In_Addr
[
i
] = 
Rem­³d_B¿m0_Addr
;

540 
	gRem­³d_B¿m0_Addr
++ ;

543 
	gi
=0; i<
R
*
	gC
/4; i++){

544 
	gFig_In_Addr
[
i
] = 
Rem­³d_B¿m0_Addr
;

545 
	gRem­³d_B¿m0_Addr
++ ;

548 
	gi
=0; i<3; i++){

549 
	gj
=0; j<3; j++){

550 
	gGx_Addr
[
i
][
j
] = 
Rem­³d_B¿m0_Addr
;

551 
	gRem­³d_B¿m0_Addr
++;

555 
	gi
=0; i<3; i++){

556 
	gj
=0; j<3; j++){

557 
	gGy_Addr
[
i
][
j
] = 
Rem­³d_B¿m0_Addr
;

558 
	gRem­³d_B¿m0_Addr
++;

563 
	gi
=0; i<
R
*
	gC
/4; i++){

564 
	gFig_Out_Addr
[
i
] = 
Rem­³d_B¿m1_Addr
;

565 
	gRem­³d_B¿m1_Addr
++;

568 cÚ¡ 
	gK”Ãl_IO_Num
 = 
CÚ¡_Num
 + 
R
*
C
/4 + 3*3 + 3*3 + R*C/4;

569 cÚ¡ 
	gK”Ãl_Num_P”_Block
 = 1;

570 
	gK”Ãl_IO_Addr
[
K”Ãl_IO_Num
][
K”Ãl_Num_P”_Block
+1];

574 
	gIt
=1;

575 
	gRow_Index
;

576 
	gp
=0;…<
	gK”Ãl_Num_P”_Block
;…++){

578 
	gRow_Index
 = 0;

581 
	gi
=0; i<
	gCÚ¡_Num
; i++){

582 
	gK”Ãl_IO_Addr
[
Row_Index
][
It
] = 
CÚ¡_In_Addr
[
i
];

583 if(
	gp
==0){

584 
K”Ãl_IO_Addr
[
Row_Index
][0] = 
D©a_To_ID
("CÚ¡_In", 
i
, 0);

586 
	gRow_Index
++;

590 
	gi
=0; i<
R
*
	gC
/4; i++){

591 
	gK”Ãl_IO_Addr
[
Row_Index
][
It
] = 
Fig_In_Addr
[
i
];

592 if(
	gp
==0){

593 
K”Ãl_IO_Addr
[
Row_Index
][0] = 
D©a_To_ID
("Fig_In", 
i
, 0);

595 
	gRow_Index
++;

598 
	gi
=0; i<3; i++){

599 
	gj
=0; j<3; j++){

600 
	gK”Ãl_IO_Addr
[
Row_Index
][
It
] = 
Gx_Addr
[
i
][
j
];

601 if(
	gp
==0){

602 
K”Ãl_IO_Addr
[
Row_Index
][0] = 
D©a_To_ID
("Gx", 
i
, 
j
);

604 
	gRow_Index
++;

608 
	gi
=0; i<3; i++){

609 
	gj
=0; j<3; j++){

610 
	gK”Ãl_IO_Addr
[
Row_Index
][
It
] = 
Gy_Addr
[
i
][
j
];

611 if(
	gp
==0){

612 
K”Ãl_IO_Addr
[
Row_Index
][0] = 
D©a_To_ID
("Gy", 
i
, 
j
);

614 
	gRow_Index
++;

619 
	gi
=0; i<
R
*
	gC
/4; i++){

620 
	gK”Ãl_IO_Addr
[
Row_Index
][
It
] = 
Fig_Out_Addr
[
i
];

621 if(
	gp
==0){

622 
K”Ãl_IO_Addr
[
Row_Index
][0] = 
D©a_To_ID
("Fig_Out", 
i
, 0);

624 
	gRow_Index
++;

628 
	gIt
++;

632 
	gi
=0; i<
	gK”Ãl_IO_Num
; i++){

633 
	gj
=0; j<
	gK”Ãl_Num_P”_Block
+1; j++){

634 
	gfHªdË
 << 
	gK”Ãl_IO_Addr
[
i
][
j
] << " ";

636 
	gfHªdË
 << 
	g¡d
::
’dl
;

638 
	gfHªdË
.
þo£
();

	@
1
.
1
/usr/include
2
21
config.h
dfg-gen.cpp
